async function fetchConfigAndInit() { try { const t = "https://growthatkyte.github.io/web/scripts/landing-pages-list.json", e = await fetch(t); if (!e.ok) throw new Error("Failed to load landing pages configuration"); const o = await e.json(); document.addEventListener("DOMContentLoaded", (() => { applyRedirectClasses(o), loadScript("https://cdn.kyteapp.com/$web/kyte-analytics-short-unique-id.js", (() => console.log("Tracking initialized"))) })), document.addEventListener("click", (t => handleRedirection(t, o))) } catch (t) { console.error("Error initializing landing pages:", t) } } function loadScript(t, e) { var o = document.createElement("script"); o.type = "text/javascript", o.onload = e, o.src = t, document.head.appendChild(o) } function applyRedirectClasses(t) { const e = window.location.pathname, o = document.querySelectorAll('input[type="submit"], button[type="submit"]'), n = t[e]; n && n.redirectClass && o.forEach((t => { t.classList.add(n.redirectClass) })) } function handleRedirection(t, e) { const o = t.target; if (o.matches(".catalog-redir, .control-redir, .cpp-redir")) { t.preventDefault(); const n = e[window.location.pathname]; if (!n) return; constructAndRedirect(n, extractAndStoreUTMParams(), o.classList.contains("cpp-redir")) } } function extractAndStoreUTMParams() { let t = { utm_source: document.referrer ? new URL(document.referrer).hostname : "direct", utm_medium: "web", utm_campaign: window.location.pathname.replace(/^\//, "").replace(/\/$/, "").replace(/\//g, "_"), utm_content: "", utm_term: "" }; const e = new URLSearchParams(window.location.search); for (let o of ["utm_source", "utm_medium", "utm_campaign", "utm_term", "utm_content"]) e.has(o) && (t[o] = e.get(o)); return Object.keys(t).forEach((e => localStorage.setItem(e, t[e]))), t } function isMobileDevice() { return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) } function isIOSDevice() { return /iPad|iPhone|iPod/.test(navigator.userAgent) || "MacIntel" === navigator.platform && navigator.maxTouchPoints > 1 } function constructAndRedirect(t, e, o) { const n = `utm_source=${e.utm_source}&utm_medium=${e.utm_medium}&utm_campaign=${e.utm_campaign}`, i = encodeURIComponent(n); let a, c, r, s; if (o) return isMobileDevice() ? void (window.location.href = isIOSDevice() ? t.ios : t.android) : void (window.location.href = `https://web.kyteapp.com/login?${n}`); { const o = `${e.utm_campaign}`; switch (t.redirectClass) { case "control-redir": a = "com.kytecontrol", c = "com.kytecontrol", r = "6472947922", s = `control_${o}`; break; case "catalog-redir": a = "com.kyte.catalog", c = "com.kytecatalog", r = "6462521196", s = `catalog_${o}`; break; default: a = "com.kyte", c = "com.kytepos", r = "1345983058", s = `default_${o}` }const n = `https://kyteapp.page.link/?link=${i}&apn=${a}&ibi=${c}&isi=${r}&utm_source=${e.utm_source}&utm_medium=${e.utm_medium}&utm_campaign=${e.utm_campaign}&pt=120346822&ct=${s}&mt=8`; window.location.href = n } }
