function loadScript(e, t) { var n = document.createElement("script"); n.type = "text/javascript", n.onload = t, n.src = e, document.head.appendChild(n) } async function loadLandingPagesConfig(e) { try { const t = await fetch(e); if (!t.ok) throw new Error("Network response was not ok"); return await t.json() } catch (e) { return console.error("There has been a problem with your fetch operation:", e) } } let landingPagesConfig; function applyRedirectClasses() { const e = window.location.pathname, t = document.querySelectorAll('input[type="submit"], button[type="submit"]'), n = landingPagesConfig[e]; n && n.redirectClass && t.forEach((e => { e.classList.add(n.redirectClass) })) } function handleRedirection(e) { const t = window.location.pathname, n = landingPagesConfig[t]; if (!n) return; let o = extractAndStoreUTMParams(), i = o.utm_campaign.replace(/^\//, "").replace(/\/$/, "").replace(/\//g, "_"); const a = `utm_source=${encodeURIComponent(o.utm_source)}&utm_medium=${encodeURIComponent(o.utm_medium)}&utm_campaign=${encodeURIComponent(i)}`; let c = constructDynamicLink(n, "https://kyteapp.page.link/", encodeURIComponent(`https://web.kyteapp.com/login?${a}`), e.classList, o, i); if (c) { const t = e.closest("form"); if (t) { t.querySelector('input[name="_redir"]').value = c, t.submit() } } } function extractAndStoreUTMParams() { let e = { utm_campaign: window.location.pathname.replace(/^\//, "").replace(/\/$/, "").replace(/\//g, "_"), referrer: document.referrer, utm_source: document.referrer ? new URL(document.referrer).hostname : "", utm_medium: "web" }; const t = new URLSearchParams(window.location.search);["utm_source", "utm_medium", "utm_campaign", "utm_term", "utm_content"].forEach((n => { t.has(n) && (e[n] = t.get(n)) })); return ["aid", "kid", "pkid", "cid", "email", "fbclid", "gclid", ...Object.keys(e)].forEach((t => { const n = localStorage.getItem(t) || e[t]; n && (localStorage.setItem(t, n), e[t] = n) })), e } function initializeTracking() { console.log("Tracking script loaded and initialized") } function isMobileDevice() { const e = navigator.userAgent; return /Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e) || e.includes("Macintosh") && "ontouchend" in document } function isIOSDevice() { const e = navigator.userAgent; return /iPad|iPhone|iPod/.test(e) || "MacIntel" === navigator.platform && navigator.maxTouchPoints > 1 } function isDesktop() { return !isMobileDevice() } function constructDynamicLink(e, t, n, o, i, a) { let c = `${t}?link=${n}`; const r = isIOSDevice(), s = isDesktop(); if (o.contains("cpp-redir")) if (s) c = "https://web.kyteapp.com/login"; else { const t = r ? e.ios : e.android; c = `${t.startsWith("http") ? t : `https://${t}`}?${queryParams}` } else c += `&apn=${o.contains("catalog-redir") ? "com.kyte.catalog" : o.contains("control-redir") ? "com.kytecontrol" : "com.kyte"}&ibi=${o.contains("catalog-redir") ? "com.kytecatalog" : o.contains("control-redir") ? "com.kytecontrol" : "com.kytepos"}&isi=${o.contains("catalog-redir") ? "6462521196" : o.contains("control-redir") ? "6472947922" : "1345983058"}`; return c += `&utm_source=${encodeURIComponent(i.utm_source)}&utm_medium=${encodeURIComponent(i.utm_medium)}&utm_campaign=${encodeURIComponent(a)}&pt=120346822&ct=${o.contains("catalog-redir") ? "catalog" : o.contains("control-redir") ? "control" : "default"}_${a}&mt=8`, c } document.addEventListener("DOMContentLoaded", (function () { loadLandingPagesConfig("https://growthatkyte.github.io/web/scripts/landing-pages-list.json").then((e => { landingPagesConfig = e, applyRedirectClasses() })), loadScript("https://cdn.kyteapp.com/$web/kyte-analytics-short-unique-id.js", initializeTracking) })), document.addEventListener("click", (function (e) { const t = e.target; t.matches(".catalog-redir, .control-redir, .cpp-redir") && (e.preventDefault(), handleRedirection(t)) }));