async function initializeLandingPageRedirection(){try{const t=await fetchConfig();"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>initialize(t))):initialize(t)}catch(t){console.error("Initialization failed:",t)}}async function fetchConfig(){const t=await fetch("https://growthatkyte.github.io/web/scripts/landing-pages-list.json");if(!t.ok)throw new Error("Failed to fetch landing pages configuration");return t.json()}function initialize(t){applyButtonClasses(t),appendUTMParamsToLinks(),setupFormHandler(t)}function applyButtonClasses(t){const e=normalizePath(window.location.pathname);document.querySelectorAll('input[type="submit"], button[type="submit"]').forEach((n=>{shouldApplyClass(n,t,e)&&(n.classList.add(t[e].redirectClass),console.log(`Applied '${t[e].redirectClass}' to buttons for path: ${e}`))}))}function shouldApplyClass(t,e,n){return!t.classList.contains("mauticform-button")&&!t.classList.contains("direct-button")&&!t.classList.contains("auth-submit")&&e[n]}function setupFormHandler(t){const e=document.getElementById("LeadForm");e&&e.addEventListener("submit",(e=>{e.preventDefault();const n=getUTMParams();handleRedirection(t,n)}))}function handleRedirection(t,e){const n=t[normalizePath(window.location.pathname)]||{},a=n.redirectClass||"default",i=isMobileDevice()?handleMobileRedirection(a,n,e):createRedirectUrl("https://web.auth.kyteapp.com/signup",e);window.location.href=i}function handleMobileRedirection(t,e,n){return"cpp-redir"===t?handleCPPRedirection(e,n):createStaticLink(t,n)}function handleCPPRedirection(t,e){return isIOSDevice()&&t.ios?appendUTMParams(t.ios,e):isAndroidDevice()&&t.android?appendUTMParams(t.android,e):createRedirectUrl("https://web.auth.kyteapp.com/signup",e)}function createStaticLink(t,e){const n={default:"https://pos.auth.kyteapp.com","catalog-redir":"https://catalog.auth.kyteapp.com","control-redir":"https://control.auth.kyteapp.com"};return appendUTMParams(n[t]||n.default,e)}function createRedirectUrl(t,e){return appendUTMParams(t,e)}function appendUTMParams(t,e){const n=new URL(t);return Object.entries(e).forEach((([t,e])=>{e&&n.searchParams.set(t,e)})),n.toString()}function normalizePath(t){return t.endsWith("/")?t.slice(0,-1):t}function getUTMParams(){const t=new URLSearchParams(location.search),e=getStoredParams(),n=getFormValues(),a={};return["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","fbclid","ttclid","campaignid","adgroupid","exp_email_only_signup"].forEach((i=>{a[i]=t.get(i)||e[i]||n[i]||""})),a.utm_campaign||(a.utm_campaign=normalizePath(window.location.pathname).slice(1)||"homepage"),storeParams(a),a}function getStoredParams(){const t={};return["localStorage","sessionStorage"].forEach((e=>{const n=window[e];["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","fbclid","ttclid","campaignid","adgroupid"].forEach((e=>{const a=n.getItem(e);a&&(t[e]=a)}))})),t}function storeParams(t){Object.entries(t).forEach((([t,e])=>{e&&(localStorage.setItem(t,e),sessionStorage.setItem(t,e))}))}function getFormValues(){const t=document.forms.LeadForm;if(!t)return{};const e={};return Array.from(t.elements).forEach((t=>{t.name&&t.value&&(e[t.name]=t.value)})),e}function appendUTMParamsToLinks(){const t=getUTMParams();document.querySelectorAll("a").forEach((e=>{try{e.href&&e.href.startsWith("http")&&(e.href=appendUTMParams(e.href,t))}catch(t){console.warn("Error processing link:",e.href,t)}}))}function isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function isIOSDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}function isAndroidDevice(){return/Android/.test(navigator.userAgent)}initializeLandingPageRedirection();
