async function initializeLandingPageRedirection() { try { const t = "https://growthatkyte.github.io/web/scripts/landing-pages-list.json", e = await fetch(t); if (!e.ok) throw new Error("Failed to fetch landing pages configuration"); const n = await e.json(); "loading" === document.readyState ? document.addEventListener("DOMContentLoaded", (() => applyClasses(n))) : applyClasses(n), document.addEventListener("click", (t => { const e = t.target.closest('input[type="submit"], button[type="submit"]'); e && (e.classList.contains("catalog-redir") || e.classList.contains("cpp-redir") || e.classList.contains("control-redir")) && (t.preventDefault(), handleRedirection(e, n)) })) } catch (t) { console.error("Initialization failed:", t) } } function normalizePath(t) { return t.endsWith("/") ? t.slice(0, -1) : t } function applyClasses(t) { const e = normalizePath(window.location.pathname), n = document.querySelectorAll('input[type="submit"], button[type="submit"]'); Object.keys(t).forEach((i => { if (normalizePath(i) === e) { const o = t[i].redirectClass; n.forEach((t => t.classList.add(o))), console.log(`Applied '${o}' to buttons for path: ${e}`) } })) } function handleRedirection(t, e) { const n = normalizePath(window.location.pathname), i = e[normalizePath(n)]; if (console.log(`Current path: ${n}`), console.log("Configuration found:", i), !i) return void console.error("Configuration missing for this page:", n); redirectUser(i, getUTMParams(), t.classList.contains("cpp-redir")) } function getUTMParams() { const t = new URLSearchParams(location.search), e = {}; return ["utm_source", "utm_medium", "utm_campaign", "utm_content", "utm_term"].forEach((n => { e[n] = t.get(n) || "" })), e } function redirectUser(t, e, n) { const i = n ? handleCPPRedirection(t, isMobileDevice()) : createDynamicLink(t.redirectClass, e); window.location.href = i } function createDynamicLink(t, e) { const n = new URLSearchParams(e).toString(); return `https://kyteapp.page.link/?${`link=${encodeURIComponent(`https://web.kyteapp.com/login?${n}`)}&apn=${t}&ibi=${t}&isi=123456789&ct=${t}_${e.utm_campaign}`}` } function handleCPPRedirection(t, e) { if (!e) { return `https://web.kyteapp.com/login?${new URLSearchParams(getUTMParams()).toString()}` } return isIOSDevice() ? t.ios : t.android } function isMobileDevice() { return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) } function isIOSDevice() { return /iPad|iPhone|iPod/.test(navigator.userAgent) || "MacIntel" === navigator.platform && navigator.maxTouchPoints > 1 } function loadScript(t, e) { const n = document.createElement("script"); n.src = t, n.onload = e, document.head.appendChild(n) } initializeLandingPageRedirection();