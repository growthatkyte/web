function loadScript(t, e) { var n = document.createElement("script"); n.type = "text/javascript", n.onload = e, n.src = t, document.head.appendChild(n) } async function loadLandingPagesConfig(t) { try { const e = await fetch(t); if (!e.ok) throw new Error("Network response was not ok"); return await e.json() } catch (t) { return console.error("There has been a problem with your fetch operation:", t) } } let landingPagesConfig; function applyRedirectClasses() { const t = window.location.pathname, e = document.querySelectorAll('input[type="submit"], button[type="submit"]'), n = landingPagesConfig[t]; n && n.redirectClass && e.forEach((t => { t.classList.add(n.redirectClass) })) } function handleRedirection(t) { const e = window.location.pathname, n = landingPagesConfig[e]; if (!n) return; let o = extractAndStoreUTMParams(), i = o.utm_campaign.replace(/^\//, "").replace(/\/$/, "").replace(/\//g, "_"); const a = `utm_source=${encodeURIComponent(o.utm_source)}&utm_medium=${encodeURIComponent(o.utm_medium)}&utm_campaign=${encodeURIComponent(i)}`; let c = constructDynamicLink(n, "https://kyteapp.page.link/", encodeURIComponent(`https://web.kyteapp.com/login?${a}`), t.classList, o, i); if (c) { const e = t.closest("form"); if (e) { e.querySelector('input[name="_redir"]').value = c, e.submit() } } } function extractAndStoreUTMParams() { let t = { utm_campaign: window.location.pathname.replace(/^\//, "").replace(/\/$/, "").replace(/\//g, "_"), referrer: document.referrer, utm_source: document.referrer ? new URL(document.referrer).hostname : "", utm_medium: "web" }; const e = new URLSearchParams(window.location.search);["utm_source", "utm_medium", "utm_campaign", "utm_term", "utm_content"].forEach((n => { e.has(n) && (t[n] = e.get(n)) })); return ["aid", "kid", "pkid", "cid", "email", "fbclid", "gclid", ...Object.keys(t)].forEach((e => { const n = localStorage.getItem(e) || t[e]; n && (localStorage.setItem(e, n), t[e] = n) })), t } function initializeTracking() { console.log("Tracking script loaded and initialized") } function isMobileDevice() { const t = navigator.userAgent; return /Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t) || t.includes("Macintosh") && "ontouchend" in document } function isIOSDevice() { const t = navigator.userAgent; return /iPad|iPhone|iPod/.test(t) || "MacIntel" === navigator.platform && navigator.maxTouchPoints > 1 } function isDesktop() { return !isMobileDevice() } function constructDynamicLink(t, e, n, o, i, a) { let c = e; const r = isIOSDevice(), s = isDesktop(); return o.contains("cpp-redir") ? s ? c += `?link=${n}` : (c = r ? t.ios : `https://${t.android}`, r || t.android.startsWith("http") || (c = `https://${t.android}`)) : (c += `?link=${n}&apn=${o.contains("catalog-redir") ? "com.kyte.catalog" : o.contains("control-redir") ? "com.kytecontrol" : "com.kyte"}&ibi=${o.contains("catalog-redir") ? "com.kytecatalog" : o.contains("control-redir") ? "com.kytecontrol" : "com.kytepos"}&isi=${o.contains("catalog-redir") ? "6462521196" : o.contains("control-redir") ? "6472947922" : "1345983058"}`, c += `&pt=120346822&ct=${o.contains("catalog-redir") ? "catalog" : o.contains("control-redir") ? "control" : "default"}_${a}&mt=8`), c } document.addEventListener("DOMContentLoaded", (function () { loadLandingPagesConfig("https://growthatkyte.github.io/web/scripts/landing-pages-list.json").then((t => { landingPagesConfig = t, applyRedirectClasses() })), loadScript("https://cdn.kyteapp.com/$web/kyte-analytics-short-unique-id.js", initializeTracking) })), document.addEventListener("click", (function (t) { const e = t.target; e.matches(".catalog-redir, .control-redir, .cpp-redir") && (t.preventDefault(), handleRedirection(e)) }));